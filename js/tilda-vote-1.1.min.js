function t_removeEl(e){e.parentNode&&e.parentNode.removeChild(e)}function tvote__init(e){var t,o,r;document.getElementById("allrecords").getAttribute("data-tilda-mode")||(t=new Date,e=tvote__makeFullVoteID(o=document.querySelector("#rec"+e).querySelector(".t-vote")),t_vote__checkVoteCondition(r={type:o.getAttribute("data-vote-type"),voteID:e,voteEl:o,voteVisibility:o.getAttribute("data-vote-visibility"),startDate:t}),"yes"!==o.getAttribute("data-vote-finished")?setTimeout(function(){t_vote__initOneVote(r)},500):o.classList.add("t-vote_sended"))}function tvote__makeFullVoteID(e){e[0]&&(e=e[0]);var t=e.getAttribute("data-vote-id");if(t){t=(t=document.querySelector("#allrecords").getAttribute("data-tilda-project-id")+t).replace("&quot;","").replace("&#039;","").replace(/[&/\\#,+()$~%.'":;*?!<>{}\-_\s]/g,"");return e.setAttribute("data-vote-id",t),t}}function t_vote__checkVoteCondition(e){var t,o=t_vote__getCookie("vote"+e.voteID),r=t_vote__getCookie("voteresult"+e.voteID);("yes"===e.voteVisibility||"onclick"===e.voteVisibility&&o)&&(t=e.voteEl.querySelectorAll(".t-vote__btn-res"),Array.prototype.forEach.call(t,function(e){e.style.display="block"})),o&&e.voteEl.classList.add("js-vote-sended","t-vote_sended"),"single"===e.type&&o&&r&&e.voteEl.querySelector('[data-answer-id="'+r+'"] .t-vote__btn-el').classList.add("t-vote__btn-el_active"),tvote__getResult(e.voteID)}function t_vote__getCookie(e){e=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([.$?*|{}()[\]\\/+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function tvote__getResult(o){var e,r,s=document.querySelector('[data-vote-id="'+o+'"]'),n=s.getAttribute("data-vote-type");"single"===n&&(e="https://vote.tildacdn.com/vote/1/getresult/"),"multi"===n&&(e="https://vote.tildacdn.com/vote/2/getresult/"),n&&(r=new XMLHttpRequest,e+="?voteid="+o+"&host="+location.protocol+"//"+location.host,r.open("GET",e,!0),r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.onload=function(){var t,e;200<=r.status&&r.status<400&&(e=r.responseText)&&"object"==typeof(t=JSON.parse(e))?t.error?(e=s.querySelectorAll(".t-vote__btn-res"),Array.prototype.forEach.call(e,function(e){e.style.display="none"})):("single"===n&&Array.prototype.forEach.call(Object.keys(t[0]),function(e){s.querySelector('[data-answer-id="'+e+'"] .js-vote-count').innerHTML=t[0][e]}),"multi"===n&&(Array.prototype.forEach.call(Object.keys(t[0]),function(n){var a=t[0][n],i=0;Array.prototype.forEach.call(Object.keys(a),function(e){i+=+a[e]}),Array.prototype.forEach.call(Object.keys(a),function(e){var t=a[e],o=Math.round(100*t/i),r=e.slice(0,e.indexOf("-")),e=s.querySelector('[data-question-id="'+n+'"] [data-answer-id="'+r+'"]');e&&(r=e.querySelector(".js-vote-count"),e=e.querySelector(".js-vote-percent"),r&&(r.innerHTML=t),e&&(e.innerHTML=o+"%"))})}),setTimeout(function(){$(s).trigger("tildavote:numberschanged")},1e3))):t_vote__showError(o,"")},r.onerror=function(){console.log("Fatal error: "+r),t_vote__showError(o,"")},r.send())}function t_vote__initOneVote(r){var e=r.voteEl.querySelectorAll(".js-sendvote-btn");Array.prototype.forEach.call(e,function(o){o.addEventListener("click",function(e){var t;r.voteEl.classList.contains("js-vote-sending")||(t=!0,"single"===r.type&&(r.answerID=o.closest(".js-vote-item").getAttribute("data-answer-id"),r.clickedEl=o,r.url="https://vote.tildacdn.com/vote/1/",t=t_vote__handleClick_single(r)),"multi"===r.type&&(r.url="https://vote.tildacdn.com/vote/2/",t=t_vote__handleClick_multi(r)),t&&(t_vote__itemSend(r),e.preventDefault()))})})}function t_vote__handleClick_single(e){return!(!e.clickedEl.classList.contains("t-vote__btn-el_active")&&e.voteEl.classList.contains("js-vote-sended"))&&(!e.clickedEl.classList.contains("t-vote__btn-el_active")||!e.voteEl.classList.contains("js-vote-sended")||(t_vote__getCookie("vote_candelete"+e.voteID)&&t_vote__itemDelete_single(e),!1))}function t_vote__handleClick_multi(r){var n=[],e=r.voteEl.querySelectorAll(".js-vote-question"),t=r.voteEl.querySelectorAll(".js-vote-question").length,e=Array.prototype.filter.call(e,function(e){if(e.querySelector(".js-vote-btn:checked"))return e});return!r.voteEl.classList.contains("js-vote-sended")&&(e.length!=t?("RU"===window.tildaBrowserLang?t_vote__showError(r.voteID,"Пожалуйста, ответьте на все вопросы."):t_vote__showError(r.voteID,"Please, answer all questions."),!1):(Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("data-question-id"),e=e.querySelectorAll(".js-vote-btn:checked"),o=[];Array.prototype.forEach.call(e,function(e){e=e.closest(".js-vote-item").getAttribute("data-answer-id");o.push(e+"-"+t+"-"+r.voteID)}),n.push({answer:o,question:t})}),r.answerArr=n,!0))}function t_vote__itemSend(o){o.seconds_fromStart=((new Date).getTime()-o.startDate.getTime())/1e3,t_vote__changeVoteCondition(o,"add"),o.voteEl.classList.add("js-vote-sending","t-multivote_sended"),t_vote__addLoadingStyle(o.voteEl),"onclick"===o.voteVisibility&&(e=o.voteEl.querySelectorAll(".t-vote__btn-res"),Array.prototype.forEach.call(e,function(e){e.style.display="block"}));var e=new FormData,r=new XMLHttpRequest;e.append("host",location.protocol+"//"+location.host),r.open("POST",o.url+"init/",!0),r.onload=function(){var e,t;200<=r.status&&r.status<400&&(e=r.responseText)&&"object"==typeof(t=JSON.parse(e))?(o.sessionKey=t.key,o.sessionCookie=t.session,o.voteHash=o.voteID+o.sessionKey,t_vote__itemSend_continue(o)):t_vote__showError(o.voteID,"")},r.onerror=function(){console.log("Fatal error: "+r),t_vote__changeVoteCondition(o,"remove"),t_vote__showError(o.voteID,"")},r.send(e)}function t_vote__itemSend_continue(t,e){var o=document.querySelector("#allrecords"),r=o.getAttribute("data-tilda-page-id"),o=o.getAttribute("data-tilda-project-id"),n={hash:t.voteHash,projectid:o,pageid:r,host:location.protocol+"//"+location.host,time:t.seconds_fromStart,session:t.sessionCookie};"single"===t.type&&(n.voteid=t.voteID,n.answerid=t.answerID),"multi"===t.type&&(n.multivoteid=t.voteID,n.answers=t.answerArr),e&&(n.votecaptcha=e,t_vote__changeVoteCondition(t,"add")),n=t_vote__getObjParams(n);var a=new FormData;Array.prototype.forEach.call(Object.keys(n),function(e){a.append(e,n[e])});var i=new XMLHttpRequest;i.open("POST",t.url+"send/",!0),i.onload=function(){var e;200<=i.status&&i.status<400&&(e=i.responseText)?(t.voteEl.classList.remove("js-vote-sending","t-vote_loading"),"object"==typeof(e=JSON.parse(e))?e.error?(t_vote__changeVoteCondition(t,"remove"),t.voteEl.classList.remove("t-vote_sended"),t_vote__handleServerError(e,t)):(t.voteEl.classList.add("js-vote-sended","t-vote_sended"),t_vote__writeSendCookie(e,t),(e=t.voteEl.querySelector(".t-vote__errorbox"))&&t_removeEl(e),$(t.voteEl).trigger("tildavote:resultsended")):t_vote__showError(t.voteID,"")):t_vote__showError(t.voteID,"")},i.onerror=function(){console.log("Fatal error: "+i),t_vote__showError(t.voteID,"")},i.send(a)}function t_vote__getObjParams(e,r){var n={},r=r||"";return Array.prototype.forEach.call(Object.keys(e),function(o){Array.isArray(e[o])?Array.prototype.forEach.call(e[o],function(e,t){e instanceof Object?(r=o+"["+t+"]",Object.assign(n,t_vote__getObjParams(e,r)),r=""):n[r+"["+o+"][]"]=e}):r?n[r+"["+o+"]"]=e[o]:n[o]=e[o]}),n}function t_vote__writeSendCookie(e,t){"ok"===e.message&&(t_vote__setCookie("vote"+e.voteid,t.voteHash,{expires:86400}),"single"===t.type&&(t_vote__setCookie("voteresult"+e.voteid,t.answerID,{expires:86400}),t_vote__setCookie("vote_candelete"+e.voteid,"yes",{expires:1800})))}function t_vote__itemDelete_single(t){t.seconds_fromStart=((new Date).getTime()-t.startDate.getTime())/1e3,t_vote__changeVoteCondition(t,"remove"),t.voteEl.classList.add("js-vote-sending"),t.voteEl.classList.remove("t-vote_sended"),t_vote__addLoadingStyle(t.voteEl),t.voteHash=t_vote__getCookie("vote"+t.voteID);var o={voteid:t.voteID,hash:t.voteHash,host:location.protocol+"//"+location.host},r=new FormData;Array.prototype.forEach.call(Object.keys(o),function(e){r.append(e,o[e])});var n=new XMLHttpRequest;n.open("POST",t.url+"delete/",!0),n.onload=function(){var e;200<=n.status&&n.status<400&&(e=n.responseText)?(t.voteEl.classList.remove("js-vote-sending","t-vote_loading"),"object"==typeof(e=JSON.parse(e))?e.error?(t_vote__changeVoteCondition(t,"add"),t.voteEl.classList.add("t-vote_sended"),t_vote__handleServerError(e,t)):(t.voteEl.classList.remove("js-vote-sended","t-vote_sended"),t_vote__removeSendCookie(e,t)):t_vote__showError(t.voteID,"")):t_vote__showError(t.voteID,"")},n.onerror=function(){console.log("Fatal error: "+n),t_vote__showError(t.voteID,"")},n.send(r)}function t_vote__removeSendCookie(e,t){var o;"ok"===e.message&&(o={expires:1},t_vote__setCookie("vote"+e.voteid,t.voteHash,o),t_vote__setCookie("voteresult"+e.voteid,"",o),t_vote__setCookie("vote_candelete"+e.voteid,"",o))}function t_vote__addLoadingStyle(e){setTimeout(function(){e.classList.contains("js-vote-sending")&&e.classList.add("t-vote_loading")},150)}function t_vote__handleServerError(e,t){if(6==e.error)return window.tvote_opts=t,void addTildaCaptcha();var o="",o="RU"===window.tildaBrowserLang?"Что-то пошло не так и голосование не может корректно работать. Пожалуйста, попробуйте другой браузер, отключите режим инкогнито или обратитесь к владельцу сайта.":"Something went wrong and vote doesn't work correctly. Please, try another browser, unlock private mode or write to website owner.";1==e.error&&(o="RU"===window.tildaBrowserLang?"С этого IP недавно голосовали. Пожалуйста, подождите 10 минут и попробуйте еще раз.":"Somebody has recently voted from this IP. Please wait 10 minutes and try again."),2==e.error&&(o="RU"===window.tildaBrowserLang?"С вашего IP адреса приходит слишком много запросов к серверу. Сервер временно не может принимать голоса с этого IP. Пожалуйста, попробуйте еще раз позже.":"There are too many votes from your IP. Server temporarily can't get votes from this IP. Please, try again later."),4==e.error&&(o="RU"===window.tildaBrowserLang?"Извините, но голос удалить уже нельзя. Удалить голос можно только в течение 30 минут после активации.":"Sorry, but you can't delete vote now. You can delete votes just during 30 minutes after activation."),5==e.error&&(o="RU"===window.tildaBrowserLang?"С вашего IP запросы приходят слишком часто. Пожалуйста, подождите 7 секунд прежде чем выбирать ответы в слудующих голосованиях на странице.":"Votes are sended too often from your IP. Please wait 7 seconds between choosing answers in different votes."),t_vote__showError(t.voteID,o)}function addTildaCaptcha(){var e=document.querySelector("#tildavotecaptchabox");e&&t_removeEl(e),document.body.insertAdjacentHTML("beforebegin",'<div id="tildavotecaptchabox" style="z-index: 100000;position:fixed; text-align: center; vertical-align: middle; top: 0px; left:0px; bottom: 0px; right: 0px; background: rgba(255,255,255,0.97);"><iframe id="captchaIframeBox" src="https://vote.tildacdn.com/vote/1/send/showcaptcha.php" frameborder="0" width="100%" height="100%"></iframe></div>'),window.removeEventListener("message",checkVerifyTildaVoteCaptcha),window.addEventListener("message",checkVerifyTildaVoteCaptcha)}function checkVerifyTildaVoteCaptcha(e){var t=document.querySelector("#tildavotecaptchabox");-1!==e.origin.indexOf("vote.tildacdn.com")&&(t&&t_removeEl(t),"closeiframe"!==e.data&&t_vote__itemSend_continue(window.tvote_opts,e.data))}function t_vote__showError(e,t){t=t||("RU"===window.tildaBrowserLang?"Что-то пошло не так и голосование может работать некорректно. Пожалуйста, проверьте соединение с интернетом или обратитесь к владельцу сайта.":"Something went wrong and vote doesn't work correctly. Please, check your internet connection or write to website owner.");var o,r=document.querySelector('[data-vote-id="'+e+'"]'),e=r.getAttribute("data-vote-type");e&&"single"!==e||(o="<div class='t-vote__errorbox'><div class='t-vote__errorbox-text t-text t-text_xs t-align_center' style='background-color:#333;color:#fff;padding:20px;margin-top:30px;'>"+t+"</div></div>",r.insertAdjacentHTML("afterend",o),r.style.display="none"),"multi"===e&&((e=r.querySelector(".t-vote__errorbox"))&&t_removeEl(e),o="<div class='t-vote__errorbox'><div class='t-vote__errorbox-text t-text t-text_xs t-align_center' style='background-color:#F95D51;color:#fff;padding:20px;margin:30px 0px;'>"+t+"</div></div>",(r=r.querySelectorAll(".js-sendvote-btn"))[r.length-1].insertAdjacentHTML("beforebegin",o))}function t_vote__changeVoteCondition(e,t){"multi"===e.type&&t_vote__changeStat(e,t),"single"===e.type&&"add"===t&&(t_vote__incrementAnswerNum(e.voteID,e.answerID),e.voteEl.querySelector('[data-answer-id="'+e.answerID+'"] .t-vote__btn-el').classList.add("t-vote__btn-el_active")),"single"===e.type&&"remove"===t&&(t_vote__decrementAnswerNum(e.voteID,e.answerID),e.voteEl.querySelector(".t-vote__btn-el_active").classList.remove("t-vote__btn-el_active"))}function t_vote__changeStat(e,r){var t=e.voteEl.querySelectorAll(".js-vote-question");Array.prototype.forEach.call(t,function(e){var e=e.querySelectorAll(".js-vote-item"),n=0;Array.prototype.forEach.call(e,function(e){var t,o=e.querySelector(".js-vote-count");o&&(t=+o.textContent,e=e.querySelectorAll(".js-vote-btn:checked").length,n+=t,0!==e&&"add"===r&&(n++,t++,o.innerHTML=t),0!==e&&"remove"===r&&(n--,t--,o.innerHTML=t))}),Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".js-vote-count"),o=e.querySelector(".js-vote-percent"),r=0;t&&(r=+t.textContent);e=Math.round(100*r/n);0!==n?(t&&(t.innerHTML=r),o&&(o.innerHTML=e+"%")):(t&&(t.innerHTML=0),o&&(o.innerHTML="0%"))})}),$(e.voteEl).trigger("tildavote:numberschanged")}function t_vote__incrementAnswerNum(e,t){e=document.querySelector('[data-vote-id="'+e+'"] [data-answer-id="'+t+'"] .js-vote-count'),t=e.textContent;e.innerHTML=++t}function t_vote__decrementAnswerNum(e,t){e=document.querySelector('[data-vote-id="'+e+'"] [data-answer-id="'+t+'"] .js-vote-count'),t=e.textContent;e.innerHTML=--t}function t_vote__setCookie(e,t,o){var r,n=(o=o||{}).expires;"number"==typeof n&&n&&((r=new Date).setTime(r.getTime()+1e3*n),n=o.expires=r),n&&n.toUTCString&&(o.expires=n.toUTCString());var a,i=e+"="+(t=encodeURIComponent(t));for(a in o){i+="; "+a;var s=o[a];!0!==s&&(i+="="+s)}document.cookie=i+"; SameSite=Lax;"}Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof e)throw new TypeError;for(var t=Object(this),o=t.length>>>0,r=2<=arguments.length?arguments[1]:void 0,n=0;n<o;n++)if(n in t&&e.call(r,t[n],n,t))return!0;return!1}),function(e){var t=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector;e.matches=e.matchesSelector=t||function(e){var t=document.querySelectorAll(e),o=this;return Array.prototype.some.call(t,function(e){return e===o})}}(Element.prototype),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}return null});